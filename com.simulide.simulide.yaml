id: com.simulide.simulide
runtime: org.kde.Platform
runtime-version: "5.15-25.08"
sdk: org.kde.Sdk
command: simulide
rename-icon: "simulide"
finish-args:
  - --device=dri
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --socket=pulseaudio
  - --filesystem=home
modules:
  - name: simulide
    buildsystem: qmake
    subdir: build_XX
    sources:
      - type: git
        url: https://git.launchpad.net/simulide/
        commit: 7f5ced1fdafd859e13fe68a12459fa6143561227
      - type: patch
        path: patches/fix-mcucreator-vector-out-of-bounds-write.patch
    post-install:
      - install -Dm755 -t ${FLATPAK_DEST}/bin/ ./executables/SimulIDE_1.1.0-SR1/simulide
      - install -d ${FLATPAK_DEST}/share/simulide/
      - cp -r ./executables/SimulIDE_1.1.0-SR1/data ${FLATPAK_DEST}/share/simulide
      - cp -r ./executables/SimulIDE_1.1.0-SR1/examples ${FLATPAK_DEST}/share/simulide
      - cp ../resources/qm/simulide_*.qm ${FLATPAK_DEST}/share/simulide/
      - install -Dm644 ../resources/icons/simulide.png -t ${FLATPAK_DEST}/share/icons/hicolor/256x256/apps/
      - install -D ../resources/simulide.desktop ${FLATPAK_DEST}/share/applications/com.simulide.simulide.desktop
      - install -D ../resources/com.simulide.simulide.metainfo.xml ${FLATPAK_DEST}/share/metainfo/com.simulide.simulide.metainfo.xml
